#!/usr/bin/env bash

usage() { echo -e "Usage:\t$(basename "$0") <int|ext|both>" && exit 1; }
[ $# -eq 0 ] && usage

# get all monitors: eDP1 DP1 [HDMI1] [VIRTUAL1]
# MODIFY THE ext ACCORDINGLY
read -d'\n' -r int ext _ _ < <(xrandr --query | tail -n+2 | rg "^(\w+) " -or '$1')
# rg "(\d+)/\d+x(\d+).+ (\w+)$" -or '$1 $2 $3')

m=$1
# fallback to internal monitor if the external one is not connected
xrandr --listactivemonitors | rg "$ext$" || m="$int"

case "$m" in
int)
  xrandr \
    --output "$int" --primary --auto \
    --output "$ext" --off
  list="$int"
  ;;
ext)
  xrandr \
    --output "$int" --off \
    --output "$ext" --primary --auto
  list="$ext"
  ;;
both)
  xrandr \
    --output "$int" --pos 0x282 --auto \
    --output "$ext" --pos 1366x0 --primary --auto
  list="$int, $ext"
  ;;
h | *) usage ;;
esac

# restart i3
i3-msg restart

icons="$XDG_DATA_HOME/icons"
dunstify \
  -a "Monitor" \
  -r 5 \
  -i "$icons/monitor.svg" \
  "Active monitor(s): $list"

exit 0
